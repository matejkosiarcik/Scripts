language: generic

os:
  - linux
  - osx

addons:
  apt:
    update: true
  homebrew:
    update: true
    brewfile: true

matrix:
  fast_finish: true

  include:
    - &gem-test
      language: ruby
      install: skip
      script: bundle install --gemfile='dependencies/gem/Gemfile'
    - <<: *gem-test
      if: branch = master
      os: osx

    - &npm-test
      language: node_js
      node_js: node
      install: skip
      script: node 'dependencies/npm/install.js' local
    - <<: *npm-test
      if: branch = master
      os: osx
    - <<: *npm-test
      if: branch = master
      os: windows

    - &pip-test
      language: python
      install: skip
      script: pip3 install --requirement 'dependencies/pip/requirements.txt'
    - <<: *pip-test
      if: branch = master
      language: generic
      os: osx

install: skip

before_script:
  - uname -a
  - if [ "${TRAVIS_OS_NAME}" = 'osx' ]; then sw_vers; fi

script:
  - sh 'home/install.sh'
  - sh 'setup/install.sh'
